<div class="orders-page">
 <h1 class="page-title">Your Orders</h1>

 <div class="table-wrapper" *ngIf="pagedOrders.length > 0">

  <div *ngIf="loading" class="empty-state">
  Loading ordersâ€¦
</div>

<div *ngIf="error" class="empty-state">
  Failed to load orders
</div>

    <table class="order-table">
      <thead>
        <tr>
          <th>Date</th>
          <th>Order ID</th>
          <th>Status</th>
          <th>Item</th>
          <th>Image</th>
          <th>Reorder</th>
        </tr>
      </thead>

    <tbody>
        <ng-container *ngFor="let order of pagedOrders">
          <tr *ngFor="let item of order.items; let i = index">
            
            <!-- Date -->
            <td *ngIf="i === 0" [attr.rowspan]="order.items.length">
              {{ order.date | date:'medium' }}
            </td>

            <!-- Order ID -->
            <td *ngIf="i === 0" [attr.rowspan]="order.items.length">
              {{ order.id }}
            </td>

            <!-- Status -->
            <td *ngIf="i === 0" [attr.rowspan]="order.items.length">
              <span class="status delivered">Delivered</span>
            </td>

            <!-- Item -->
           <td (click)="openDetails(order)" class="clickable">
                 {{ item.name }} Ã— {{ item.quantity }}
            </td>

            <!-- Image -->
            <td>
              <img
                class="item-image"
                [src]="item.image || 'assets/placeholder.png'"
              />
            </td>

            <!-- Reorder -->
            <td *ngIf="i === 0" [attr.rowspan]="order.items.length">
              <button class="reorder-btn" (click)="confirmReorder(order)">
                Reorder
              </button>
            </td>

            <button
  *ngIf="order.status === 'Delivered'"
  class="cancel-btn"
  (click)="cancelOrder(order)">
  Cancel / Return
</button>


          </tr>
        </ng-container>
      </tbody>
    </table>
  </div>

   <!-- Pagination -->
  <div class="pagination" *ngIf="totalPages > 1">
    <button
      *ngFor="let p of pages"
      [class.active]="p === currentPage"
      (click)="goToPage(p)">
      {{ p }}
    </button>
  </div>


  <div *ngIf="pagedOrders.length === 0" class="empty-state">
    No orders yet ðŸ›’
  </div>

  <div class="filters">
  <input
    type="text"
    placeholder="Search Order ID"
    [(ngModel)]="searchText"
    (input)="applyFilters()"
  />

  <select [(ngModel)]="statusFilter" (change)="applyFilters()">
    <option value="">All</option>
    <option value="Delivered">Delivered</option>
    <option value="Cancelled">Cancelled</option>
    <option value="Returned">Returned</option>
  </select>
</div>

<div *ngIf="loading" class="skeleton-list">
  <div class="skeleton-card" *ngFor="let i of [1,2,3]"></div>
</div>
<td data-label="Order ID">...</td>

</div>
