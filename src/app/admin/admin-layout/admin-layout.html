<div class="admin-container">

  <!-- ================= HEADER ================= -->
  <header class="admin-header">

    <div class="admin-title-wrapper">

      <div class="admin-title">
        Admin Dashboard
      </div>

      <!-- ðŸ”” Notification Bell -->
      <div class="notification-wrapper" (click)="toggleDropdown()">

        ðŸ””

        <!-- Badge -->
        <ng-container *ngIf="notifications$ | async as list">
          <span class="badge"
                *ngIf="getUnreadCount(list) > 0">
            {{ getUnreadCount(list) }}
          </span>
        </ng-container>

        <!-- ðŸ”½ Dropdown -->
        <div class="dropdown" *ngIf="isDropdownOpen" 
             (click)="$event.stopPropagation()">

          <ng-container *ngIf="notifications$ | async as list">

            <!-- âœ… NEW HEADER WITH VIEW ALL -->
         <div class="dropdown-header">
        <span>Notifications</span>
        <button class="view-all-btn"
        (click)="viewAllNotifications(list); $event.stopPropagation()">
  View All
</button>
      </div>

            <!-- Unread Notifications Only -->
            <div *ngFor="let n of getUnreadNotifications(list)"
                 class="notification-item"
                 [class.unread]="isUnread(n)">

              <div class="text">
                {{ n.message }}
              </div>

              <button (click)="viewOrder(n); $event.stopPropagation()">
                View
              </button>

            </div>

            <!-- Empty State -->
            <div *ngIf="getUnreadCount(list) === 0"
                 class="empty">
              No notifications
            </div>

          </ng-container>

        </div>

      </div>

    </div>

    <!-- Right Side -->
    <div class="admin-actions">
      <span>Welcome, Admin</span>
      <button class="logout-btn" (click)="logout()">Logout</button>
    </div>


  </header>


  <!-- ðŸ”” Toast -->
  <div class="toast" *ngIf="toastMessage">
    {{ toastMessage }}
  </div>


  <!-- ================= BODY ================= -->
  <div class="admin-body">

    <!-- Sidebar -->
    <aside class="admin-sidebar">

      <a routerLink="/admin/dashboard" routerLinkActive="active-link">
        Dashboard
      </a>

      <a routerLink="/admin/products" routerLinkActive="active-link">
        Products
      </a>

      <a routerLink="/admin/add-product" routerLinkActive="active-link">
        Add Product
      </a>

      <a routerLink="/admin/add-category" routerLinkActive="active-link">
        Add Category
      </a>

      <a routerLink="/admin/orders" routerLinkActive="active-link">
        Orders
      </a>

      <a routerLink="/admin/users" routerLinkActive="active-link">
        User
      </a>

      <a routerLink="/admin/vendors" routerLinkActive="active-link">
        Vendor
      </a>

      <div class="sidebar-bottom">
  <button class="migration-btn" (click)="migrateCategoryField()">
    ðŸ”„ Run Category Migration
  </button>
</div>

    </aside>

    <!-- Main Content -->
    <main class="admin-content">
      <router-outlet></router-outlet>
    </main>

  </div>

</div>
