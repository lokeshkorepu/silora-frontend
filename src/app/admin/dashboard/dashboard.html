<div class="dashboard-container">

  <!-- HEADER -->
  <div class="dashboard-header">
    <h2>Admin Dashboard</h2>

    <div class="header-actions">
      <button class="action-btn" (click)="exportCSV()">Export CSV</button>
      <button class="action-btn dark-toggle" (click)="toggleDarkMode()">
        ðŸŒ™
      </button>
    </div>
  </div>

  <!-- SKELETON -->
  <div *ngIf="loading" class="skeleton-grid">
    <div class="skeleton-card"></div>
    <div class="skeleton-card"></div>
    <div class="skeleton-card"></div>
    <div class="skeleton-card"></div>
  </div>

  <!-- KPI CARDS -->
  <div class="kpi-grid" *ngIf="!loading">

    <div class="kpi-card blue">
      <h3>{{ animatedTotalOrders }}</h3>
      <p>Total Orders</p>
    </div>

    <div class="kpi-card green">
      <h3>â‚¹{{ animatedRevenue }}</h3>
      <p>Total Revenue</p>
    </div>

    <div class="kpi-card purple">
      <h3>{{ animatedDelivered }}</h3>
      <p>Delivered</p>
    </div>

    <div class="kpi-card orange">
      <h3>{{ animatedPending }}</h3>
      <p>Pending</p>
    </div>

  </div>

  <!-- CHART SECTION -->
  <div class="chart-grid" *ngIf="!loading">

    <div class="chart-card">
      <h3>Revenue (Last 7 Days)</h3>
      <canvas baseChart
        [data]="revenueChartData"
        [type]="'line'">
      </canvas>
    </div>

    <div class="chart-card">
      <h3>Order Status</h3>
      <canvas baseChart
        [data]="statusChartData"
        [type]="'doughnut'">
      </canvas>
    </div>

  </div>

  <!-- RECENT ORDERS -->
  <div class="recent-orders-card" *ngIf="!loading">

    <div class="recent-header">
      <h3>Recent Orders</h3>
    </div>

    <table class="recent-table">

      <thead>
        <tr>
          <th>Order ID</th>
          <th>Customer</th>
          <th>Amount</th>
          <th>Status</th>
        </tr>
      </thead>

      <ng-container *ngFor="let order of recentOrders">

        <tr class="clickable-row"
            (click)="toggleExpand(order.id)">

          <td>{{ order.id }}</td>
          <td>{{ order.userEmail }}</td>
          <td>â‚¹{{ order.totalAmount }}</td>
          <td>
            <span class="status-pill"
              [ngClass]="{
                'delivered': order.status === 'DELIVERED',
                'pending': order.status === 'PENDING',
                'cancelled': order.status === 'CANCELLED'
              }">
              {{ order.status }}
            </span>
          </td>
        </tr>

        <tr *ngIf="expandedOrderId === order.id" class="expanded-row">
          <td colspan="4">
            <div class="expanded-content">
              <div *ngFor="let item of order.items">
                â€¢ {{ item.productId }} â€” Qty: {{ item.quantity }}
              </div>
            </div>
          </td>
        </tr>

      </ng-container>

    </table>

  </div>

</div>
